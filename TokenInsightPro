# scripts/market_trends.py

import requests
import pandas as pd

def fetch_market_trends(api_url):
    """
    Fetch market trends from an API.
    
    :param api_url: Base URL of the market API
    :return: DataFrame with market trends data
    """
    response = requests.get(f'{api_url}/market_trends')
    response.raise_for_status()
    data = response.json()
    df = pd.DataFrame(data)
    return df

def analyze_market_trends(df):
    """
    Analyze market trends.
    
    :param df: DataFrame with market trends data
    :return: Analysis results as DataFrame
    """
    analysis = {
        'total_market_cap': df['market_cap'].sum(),
        'average_daily_volume': df['daily_volume'].mean(),
        'top_5_tokens': df.nlargest(5, 'market_cap')[['id', 'market_cap']]
    }
    analysis_df = pd.DataFrame([analysis])
    return analysis_df

# Example usage:
# api_url = 'https://api.crypto.example.com'
# market_trends_df = fetch_market_trends(api_url)
# print(market_trends_df)
# market_trends_analysis_df = analyze_market_trends(market_trends_df)
# print(market_trends_analysis_df)
